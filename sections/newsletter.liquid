<section class="newsletter {% if section.settings.full_width %}newsletter--full-width{% endif %}">
  <div class="newsletter__inner">
    <div class="newsletter__content">
      {% if section.settings.heading != blank %}
        <h2 class="newsletter__heading">{{ section.settings.heading }}</h2>
      {% endif %}

      {% if section.settings.text != blank %}
        <p class="newsletter__text text-muted">{{ section.settings.text }}</p>
      {% endif %}
    </div>

    {% form 'customer', class: 'newsletter__form' %}
      <input type="hidden" name="contact[tags]" value="newsletter">

      {% if form.errors %}
        <div class="newsletter__message newsletter__message--error">
          {{ form.errors.translated_fields.email | capitalize }}
          {{ form.errors.messages.email }}
        </div>
      {% elsif form.posted_successfully? %}
        <div class="newsletter__message newsletter__message--success">
          {{ 'sections.newsletter.success' | t }}
        </div>
      {% endif %}

      <div class="newsletter__input-group">
        <input
          type="email"
          name="contact[email]"
          class="input newsletter__input"
          placeholder="{{ 'sections.newsletter.placeholder' | t }}"
          autocomplete="email"
          required
        >
        <button type="submit" class="btn btn--primary newsletter__button">
          {{ 'sections.newsletter.submit' | t }}
        </button>
      </div>
    {% endform %}
  </div>
</section>

{% stylesheet %}
  .newsletter {
    padding: var(--space-4xl) var(--page-margin);
  }

  .newsletter--full-width {
    background-color: var(--color-secondary);
  }

  .newsletter__inner {
    max-width: 40rem;
    margin: 0 auto;
    text-align: center;
    display: flex;
    flex-direction: column;
    gap: var(--space-xl);
  }

  .newsletter__content {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
  }

  .newsletter__heading {
    margin: 0;
  }

  .newsletter__text {
    margin: 0;
  }

  .newsletter__form {
    width: 100%;
  }

  .newsletter__input-group {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
  }

  .newsletter__input {
    text-align: center;
  }

  .newsletter__message {
    padding: var(--space-sm) var(--space-md);
    border-radius: var(--input-border-radius);
    margin-bottom: var(--space-md);
    font-size: var(--font-size-sm);
  }

  .newsletter__message--error {
    background-color: rgb(214 69 69 / 0.1);
    color: var(--color-error);
  }

  .newsletter__message--success {
    background-color: rgb(45 90 71 / 0.1);
    color: var(--color-success);
  }

  @media (min-width: 480px) {
    .newsletter__input-group {
      flex-direction: row;
    }

    .newsletter__input {
      flex: 1;
      text-align: left;
    }

    .newsletter__button {
      flex-shrink: 0;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "t:sections.newsletter.name",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "t:sections.newsletter.heading",
      "default": "Subscribe to our newsletter"
    },
    {
      "type": "text",
      "id": "text",
      "label": "t:sections.newsletter.text",
      "default": "Be the first to know about new collections and exclusive offers."
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "t:sections.newsletter.full_width",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "t:sections.newsletter.name"
    }
  ]
}
{% endschema %}
